<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
     integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
     crossorigin="anonymous" referrerpolicy="no-referrer">
    {% if captcha %}
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    {% endif %}
    <script src="{{ url_for('static', filename='func.js') }}"></script>
    <script src="{{ url_for('static', filename='render.js') }}"></script>
    <div>
    </div>
    <!--<link rel="stylesheet" href="master.css">-->
    <style>
        *
        {
            box-sizing: border-box;
        }
        body
        {
            margin: 0;
            background-color: #f0f0f0;
        }
        #head div
        {
            display: flex;
        }
        #head
        {
            padding: 0 100px;
            width: 100%;
            height: 42px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            background-color: {{ brand_color }};
        }
        #wiki_name, #head div:first-child a
        {
            line-height: 42px;
            text-align: center;
            color: white;
            text-decoration: none;
        }
        #wiki_name, #head div:first-child a[href="/license"]
        {
            margin-right: 50px;
            
        }
        #search *
        {
            margin: 0;
            padding: 0;
            height: 42px;
            box-sizing: border-box;
            min-width: 42px;
            border-radius: 0;
            border: #808080 solid 1px;
            box-shadow: none;
            line-height: 40px;
        }
        /*#search *:not([name="search_query"])
        {
            box-sizing: content-box;
        }*/
        #search [name="search_query"]
        {
            padding: 4px 8px;
            box-sizing: border-box;
        }
        #search
        {
            display: flex;
        }
        i
        {
            border: 0 !important;
        }
        #foot div
        {
            margin-left: 50px;
        }
        #user
        {
            width: 42px;
            height: 42px;
        }
        #content
        {
            margin: 5px 50px;
        }
        table.border, table.border th, table.border td
        {
            border: 1px solid black;
            border-collapse: collapse;
        }
        .danger, .ok, .normal
        {
            border: 0;
            height: 30px;
            padding: 1px 13px;
        }
        .danger, .ok
        {
            color: white;
            border: 0;
            height: 30px;
            padding: 1px 13px;
        }
        .danger
        {
            background-color: #d9534f;
        }
        .ok
        {
            background-color: #0275d8;
        }
        .alert, .error
        {
            width: 100%;
            border-width: 1px;
            border-radius: .25rem;
            border-style: solid;
            padding: 12px;
        }
        .alert
        {
            background-color: #aacdec;
            border-color: #c9c9c9;
        }
        .error
        {
            background-color: #f2938c;
            border-color: #d83933;
        }
        .block
        {
            display: block;
        }
        .inline
        {
            display: inline;
        }
        a
        {
            text-decoration: none;
            color: #0275d8;
        }
        a:active
        {
            color: red;
        }
        #modal_background
        {
            background-color: #000000;
            width: 100%;
            height: 100%;
            opacity: 0.5;
            position: fixed; 
        }
        .modal
        {
            position: fixed;
            top: 40%;
            left: 30%;
            width: 40%;
            box-sizing: border-box;
            background-color: #ffffff;
            z-index: 1;
            padding: 1%;
            display: none;
        }
        .title
        {
            display: inline;
            color: #303030;
            margin: 0;
        }
        .button_like_link
        {
            border: none;
            padding: 0;
            font-size: 1em;
            background: none;
            display: inline;
            color: #0275d8;
        }
        .danger[disabled], .ok[disabled]
        {
            cursor: not-allowed;
            opacity: 0.65;
        }
        .nomargin
        {
            margin: 0;
        }
        .namespace
        {
            color: #666;
        }
        #ctn-header
        {
            display: flex;
            justify-content: space-between;
        }
        #menu, #menu2 > div
        {
            display: flex;
        }
        #menu
        {
            height: 35px;
        }
        #menu2 > div
        {
            border: 1px solid black;
            height: 40px;
        }
        #menu2 > div:not(:last-child)
        {
            margin-bottom: 10px;
        }
        #menu a
        {
            border: 1px solid #808080;
            padding: 5px 13px;
            color: unset;
            text-decoration: none;
            line-height: 23px;
        }
        #menu a:not(:last-child), #menu2 a:not(:last-child)
        {
            border-right: 0;
        }
        @media (max-width: 767px)
        {
            .modal
            {
                left: 0%;
                width: 100%;
            }
        }
        #menu2 a
        {
            padding: 8px 12px;
            line-height: 22px;
        }
        #menu2 a:not(.menu2-selected)
        {
            color: unset;
        }
        .menu2-selected
        {
            color: {{ brand_color }};
        }
        #menu2
        {
            margin: 16px 0;
        }
        th, td
        {
            text-align: left;
        }
        .flex
        {
            display: flex;
        }
        .fullwidth
        {
            width: 100%;
        }
        .comment-wrap
        {
            padding-bottom: 20px;
        }
        .comment
        {
            border: 1px solid gray;
            border-radius: 4px;
            display: inline-block;
            width: auto;
            min-width: 400px;
            max-width: 100%;
        }
        .comment-no
        {
            color: #0275d8;
        }
        .comment-header
        {
            display: flex;
            justify-content: space-between;
            padding: 7px;
            padding-left: 10px;
            background-color: #d5d5d5;
        }
        .comment-presenter > .comment-header
        {
            background-color: #b0d3ad;
        }
        .comment-text
        {
            max-height: 500px;
            overflow-y: auto;
            padding: 13px;
        }
        .comment-special > .comment-text
        {
            background-color: #fc6;
        }
        </style>
    {% block css %}{% endblock %}
    <title>{{ wiki_name }}</title>
</head>
<body>
    <div id="modal_background" style="display: none;"></div>
    {% block outcontent %}{% endblock %}
    <div id="head">
        <div>
            <div id="wiki_name">
                <a href="/">{{ wiki_name }}</a></div>
            <a href="/license">LICENSE</a>
            {% if isowner %}
            <a href="/admin_tool">관리 도구</a>
            {% endif %}
        </div>
        <div>
            <form id="search" action="{{ url_for('go') }}" method="get"> <!-- 검색 창 -->
                <button type="button">
                    <i class="fa-solid fa-shuffle"></i>
                </button>
                <input type="text" name="q" style="padding-left: 5px;">
                <button type="submit">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
                <button type="button">
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </form>
            <button id="user">
                <i class="fa-solid fa-user"></i>
            </button>
        </div>
    </div>
    <div id="content">
        <div id="ctn-header">
            <div>
                <h1 class="title">{{ title|safe }}</h1>
                {% if subtitle is defined %}
                <h2 class="title" style="margin-left: 8px;">({{ subtitle }})</h2>
                {% endif %}
            </div>
            {% if menu is defined %}
            <div id="menu">
                {% for i in menu %}
                <a href="{{ i.link }}" class="{{ i.clas }}" style="{{ i.style }}">{{ i.name }}</a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        <div id="ctn-data">
        {% if menu2 is defined %}
        <div id="menu2">
            {% for m in menu2 %}
            <div>
                {% for i in m %}
                <a href="{{ i.link }}" class="{{ i.clas }}" style="{{ i.style }}">{{ i.name }}</a>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
        {% endif %}
            {% block content %}{% endblock %}
        </div>
    </div>
    <div id="foot">
        <hr>
        <div>
            NewTheSeed {{ version }}
        </div>
        <div>
            {{ document_license|safe }}
        </div>
    </div>
    <script>
        function closeModal(id) {
            document.getElementById(id).style.display = "none"
            document.getElementById("modal_background").style.display = "none";
        }
        function openModal(id) {
            document.getElementById(id).style.display = "block"
            document.getElementById("modal_background").style.display = "block";
        }
        function onCaptchaCompleted(token) {
            document.getElementById("on-captcha").style.display = "block";
        }
        function callapi(href, body, then) {
            fetch(href, {"method": "post",
            "headers": {"Content-Type": "application/json"},
            "body": JSON.stringify(body)})
            .then(r => {
                if (r.ok) return r.json()
                else if (r.status == 400) return r.text().then(t => {throw new Error(t)}) 
                else throw new Error(`Request failed with status code ${r.status}`)
            })
            .then(then)
            .catch(e => {alert(e.message)})
        }
        document.querySelector("#head div:nth-child(2) form button:nth-child(4)").addEventListener("click", function () {
            location.href = `/w/${encodeURI(document.querySelector("#head div:nth-child(2) form input").value)}`
        })
        document.querySelector("#user").addEventListener("click", function () {
            location.href = '/user'
        })
        document.querySelectorAll(".confirm:not(.refresh-on-submit)").forEach(function (b) {
            b.addEventListener("submit", function (e) {
                if (!confirm("msg" in this.dataset ? this.dataset["msg"] : "계속하시겠습니까?")) {
                    e.preventDefault();
                }
            })
        })
        document.querySelectorAll(".refresh-on-submit").forEach(function (form) {
            form.addEventListener("submit", function (e) {
                e.preventDefault();
                if (this.classList.contains("confirm")) {
                    if (!confirm("msg" in this.dataset ? this.dataset["msg"] : "계속하시겠습니까?")) {
                        return
                    }
                }
                fetch(this.action, {method: this.method, body: new FormData(this)})
                .then((r) => {
                    if (r.ok) {
                        if ("customRedirect" in this.dataset) {
                            location.href = this.dataset.customRedirect
                        }
                        else {
                            location.reload()
                        }
                    }
                    else {
                        if (r.status === 400 && r.headers.get("Content-Type").startsWith("text/plain")) {
                            r.text().then(function (err) {
                                alert(err)
                            })
                        }
                        else {
                            alert(`Request failed with status code ${r.status}`)
                        }
                    }
                })
            })
        })
    </script>
    {% if req_captcha and captcha_time %}
    <script>
        setTimeout(function () {
            document.getElementById("on-captcha").style.display = "none";
            document.getElementsByClassName("g-recaptcha")[0].style.display = "block";
        }, 10);
    </script>
    {% endif %}
    {% block js %}{% endblock %}
</body>
</html>